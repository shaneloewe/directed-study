{"version":3,"file":"ng-google-one-tap.umd.js","sources":["../../../projects/ng-google-one-tap/src/lib/toke.ts","../../../projects/ng-google-one-tap/src/lib/ng-google-one-tap.service.ts","../../../projects/ng-google-one-tap/src/lib/ng-google-one-tap.module.ts","../../../projects/ng-google-one-tap/src/public-api.ts","../../../projects/ng-google-one-tap/src/ng-google-one-tap.ts"],"sourcesContent":["import { configuration } from './model/tap.model';\nimport { InjectionToken } from \"@angular/core\";\n\nexport const CONFIGURATION = new InjectionToken<configuration>('CONFIGURATION')","import { configuration, credentialRes, UserInfo } from './model/tap.model';\nimport { Injectable, NgZone } from '@angular/core';\nimport { Inject } from '@angular/core';\nimport { CONFIGURATION } from './toke';\nimport { Subject } from 'rxjs';\nimport { PromptMomentNotification } from './model/promptmoment.model';\n\ndeclare var window: any;\n@Injectable()\nexport class NgOneTapService {\n\n    private _promtMoment = new Subject<PromptMomentNotification>();\n    private _oneTapCredentialResponse = new Subject<credentialRes>();\n    private _authUserResponse = new Subject<UserInfo>();\n\n    get promtMoment() {\n        return this._promtMoment.asObservable();\n    }\n\n    get oneTapCredentialResponse() {\n        return this._oneTapCredentialResponse.asObservable();\n    }\n\n    get authUserResponse() {\n        return this._authUserResponse.asObservable();\n    }\n\n    constructor(@Inject(CONFIGURATION) private envConfig: configuration,\n    private ngZone: NgZone) { }\n\n    tapInitialize(config?: configuration) {\n        window.onload = () => {\n            this.tapRender(config);\n        }\n        if (document.readyState == 'complete') {\n            this.tapRender(config);\n        }\n    }\n\n    private tapRender(config: configuration) {\n        const conf = {...this.envConfig, ...config };\n        if (conf?.disable_exponential_cooldowntime) {\n            document.cookie = 'g_state' +'=;Path=/;';\n        }\n        window.google.accounts.id.initialize({\n            ...conf, callback: (auth) => {\n                this.ngZone.run(() => {\n                    if (conf.authvalidate_by_googleapis) {\n                        const http = new XMLHttpRequest();\n                        const url = `https://oauth2.googleapis.com/tokeninfo?id_token=${auth.credential}`;\n                        http.open('GET', url);\n                        http.send();\n                        http.onreadystatechange = () => {\n                            if (http.readyState == 4 && http.status == 200) {\n                                this._authUserResponse.next(JSON.parse(http.responseText));\n                            }\n                        };\n                    }\n                    this._oneTapCredentialResponse.next(auth);\n                });\n            }\n        });\n        window.google.accounts.id.prompt((pmt) => {\n            this._promtMoment.next(pmt);\n        });\n    }\n\n    signOut() {\n        window.google.accounts.id.disableAutoSelect();\n    }\n\n    cancelTheTap() {\n        window.google.accounts.id.cancel();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { configuration } from './model/tap.model';\nimport { NgOneTapService } from './ng-google-one-tap.service';\nimport { CONFIGURATION } from './toke';\n\n\n@NgModule({\n    declarations: [\n    ],\n    imports: [\n    ],\n    exports: [\n    ]\n})\n\nexport class NgGoogleOneTapModule {\n    constructor() {\n        let oneTapLib = document.createElement('script');\n        oneTapLib.async = true;\n        oneTapLib.src = 'https://accounts.google.com/gsi/client';\n        document.head.appendChild(oneTapLib);\n    }\n    public static config(config: configuration): any {        \n        return {\n            ngModule: NgGoogleOneTapModule,\n            providers: [\n                {provide: CONFIGURATION, useValue: config},\n                NgOneTapService\n            ]\n        }\n    }\n}\n","/*\n * Public API Surface of ng-google-one-tap\n */\n\nexport * from './lib/ng-google-one-tap.service';\nexport * from './lib/ng-google-one-tap.module';\nexport * from './lib/model/promptmoment.model';\nexport * from './lib/model/tap.model';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {CONFIGURATION as Éµa} from './lib/toke';"],"names":["InjectionToken","Subject","Injectable","Inject","NgZone","NgModule"],"mappings":"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"}