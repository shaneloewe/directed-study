{"version":3,"file":"ng-google-one-tap.js","sources":["../../../projects/ng-google-one-tap/src/lib/toke.ts","../../../projects/ng-google-one-tap/src/lib/ng-google-one-tap.service.ts","../../../projects/ng-google-one-tap/src/lib/ng-google-one-tap.module.ts","../../../projects/ng-google-one-tap/src/public-api.ts","../../../projects/ng-google-one-tap/src/ng-google-one-tap.ts"],"sourcesContent":["import { configuration } from './model/tap.model';\nimport { InjectionToken } from \"@angular/core\";\n\nexport const CONFIGURATION = new InjectionToken<configuration>('CONFIGURATION')","import { configuration, credentialRes, UserInfo } from './model/tap.model';\nimport { Injectable, NgZone } from '@angular/core';\nimport { Inject } from '@angular/core';\nimport { CONFIGURATION } from './toke';\nimport { Subject } from 'rxjs';\nimport { PromptMomentNotification } from './model/promptmoment.model';\n\ndeclare var window: any;\n@Injectable()\nexport class NgOneTapService {\n\n    private _promtMoment = new Subject<PromptMomentNotification>();\n    private _oneTapCredentialResponse = new Subject<credentialRes>();\n    private _authUserResponse = new Subject<UserInfo>();\n\n    get promtMoment() {\n        return this._promtMoment.asObservable();\n    }\n\n    get oneTapCredentialResponse() {\n        return this._oneTapCredentialResponse.asObservable();\n    }\n\n    get authUserResponse() {\n        return this._authUserResponse.asObservable();\n    }\n\n    constructor(@Inject(CONFIGURATION) private envConfig: configuration,\n    private ngZone: NgZone) { }\n\n    tapInitialize(config?: configuration) {\n        window.onload = () => {\n            this.tapRender(config);\n        }\n        if (document.readyState == 'complete') {\n            this.tapRender(config);\n        }\n    }\n\n    private tapRender(config: configuration) {\n        const conf = {...this.envConfig, ...config };\n        if (conf?.disable_exponential_cooldowntime) {\n            document.cookie = 'g_state' +'=;Path=/;';\n        }\n        window.google.accounts.id.initialize({\n            ...conf, callback: (auth) => {\n                this.ngZone.run(() => {\n                    if (conf.authvalidate_by_googleapis) {\n                        const http = new XMLHttpRequest();\n                        const url = `https://oauth2.googleapis.com/tokeninfo?id_token=${auth.credential}`;\n                        http.open('GET', url);\n                        http.send();\n                        http.onreadystatechange = () => {\n                            if (http.readyState == 4 && http.status == 200) {\n                                this._authUserResponse.next(JSON.parse(http.responseText));\n                            }\n                        };\n                    }\n                    this._oneTapCredentialResponse.next(auth);\n                });\n            }\n        });\n        window.google.accounts.id.prompt((pmt) => {\n            this._promtMoment.next(pmt);\n        });\n    }\n\n    signOut() {\n        window.google.accounts.id.disableAutoSelect();\n    }\n\n    cancelTheTap() {\n        window.google.accounts.id.cancel();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { configuration } from './model/tap.model';\nimport { NgOneTapService } from './ng-google-one-tap.service';\nimport { CONFIGURATION } from './toke';\n\n\n@NgModule({\n    declarations: [\n    ],\n    imports: [\n    ],\n    exports: [\n    ]\n})\n\nexport class NgGoogleOneTapModule {\n    constructor() {\n        let oneTapLib = document.createElement('script');\n        oneTapLib.async = true;\n        oneTapLib.src = 'https://accounts.google.com/gsi/client';\n        document.head.appendChild(oneTapLib);\n    }\n    public static config(config: configuration): any {        \n        return {\n            ngModule: NgGoogleOneTapModule,\n            providers: [\n                {provide: CONFIGURATION, useValue: config},\n                NgOneTapService\n            ]\n        }\n    }\n}\n","/*\n * Public API Surface of ng-google-one-tap\n */\n\nexport * from './lib/ng-google-one-tap.service';\nexport * from './lib/ng-google-one-tap.module';\nexport * from './lib/model/promptmoment.model';\nexport * from './lib/model/tap.model';","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {CONFIGURATION as Éµa} from './lib/toke';"],"names":[],"mappings":"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"}